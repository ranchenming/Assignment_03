---
title: "assignment 03"
author: "Chenming Ran"
date: "2/13/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r load-packages, message=TRUE, warning=TRUE, paged.print=TRUE}
library(tidyverse)
library(haven)
```
```{r import data}
trade <- read_stata("us_trade_data.dta")
trade$trade_type[trade$trade_type == "Total Exports"] <- "Export" 
trade$trade_type[trade$trade_type == "Total Imports"] <- "Import" 
head(trade,10)
```
```{r create tible}
trade_1 <- trade %>%
  filter(is.na(trade_value) == FALSE) %>% 
  group_by(year, trade_type) %>%
  summarize(trade_value = mean(trade_value))

head(trade_1,10)
```
```{r reshape data}
trade_2 <- trade_1 %>%
    pivot_wider(id_cols = year, names_from = trade_type, values_from = trade_value) 

trade_2$Net_Import = trade_2$Import-trade_2$Export

head(trade_2,10)
```

```{r line graph}
ggplot(data = trade_2, aes(year)) + 
  geom_line(aes(y = Export, colour = "blue")) + 
  geom_line(aes(y = Import, colour = "read"))
```

```{r bar graph}
ggplot(data=trade_2, aes(x=year, y=Net_Import)) +
  geom_bar(stat="identity", fill="steelblue")+
  theme_minimal()
```
```{r create tible3}
trade_3 <- trade %>%
  filter(is.na(trade_value) == FALSE, year == 2018) %>% 
  group_by(year, trade_type, district) %>%
  summarize(trade_value = mean(trade_value)) %>%
  pivot_wider(names_from = trade_type, values_from = trade_value) 

head(trade_3,10)
```











